# 点群データビューア (React版)

Three.jsとReactを使用した高機能な点群データの3D表示アプリケーションです。LASファイルとPLYファイルの両方に対応し、大規模データの最適化機能も含みます。

## 🚀 主な機能

### 📁 ファイル対応
- **LASファイル対応**: 標準的な点群データ形式（LAS）を直接読み込み
- **PLYファイル対応**: PLY形式の点群データを読み込み
- **色情報サポート**: RGB色情報の正確な読み込みと表示

### 🎮 インタラクション
- **3D操作**: マウスによる回転、ズーム、パン操作
- **表示設定**: 点のサイズ、透明度、色情報の切り替え
- **品質調整**: 4段階の品質レベル（最高品質〜低品質）
- **リアルタイム制御**: スライダーによる即座の設定変更

### ⚡ パフォーマンス最適化
- **LODシステム**: 品質レベルに応じた点数の自動調整
- **プログレッシブ読み込み**: 大規模データの段階的表示
- **メモリ効率**: 効率的なデータ構造とレンダリング

## 🛠️ 技術スタック

- **フロントエンド**: React 18, JavaScript (ES6+)
- **3Dライブラリ**: Three.js r158
- **ビルドツール**: Webpack 5, Babel
- **スタイリング**: CSS3
- **開発環境**: Webpack Dev Server

## 📦 インストールと起動

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで `http://localhost:8080` にアクセスしてください。

### 3. 本番ビルド

```bash
npm run build
```

## 🎯 使用方法

### 1. 点群データの読み込み

1. 「点群データを読み込み」ボタンをクリック
2. LASファイルまたはPLYファイルを選択
3. 自動的に3D表示が開始されます

### 2. 表示操作

- **回転**: マウス左ボタンでドラッグ
- **ズーム**: マウスホイール
- **パン**: マウス右ボタンでドラッグ

### 3. 表示設定

- **点のサイズ**: スライダーで調整（0.001〜0.1）
- **透明度**: スライダーで調整（0.1〜1.0）
- **色情報**: ボタンで色情報の表示/非表示を切り替え
- **品質レベル**: 4段階の品質調整（最高品質〜低品質）

## 📊 品質レベル設定

| レベル | 表示名 | 最大点数 | 用途 |
|--------|--------|----------|------|
| 0 | 最高品質 | 1,000,000点 | 詳細な解析用 |
| 1 | 高品質 | 500,000点 | 一般的な表示用 |
| 2 | 中品質 | 250,000点 | 軽量表示用 |
| 3 | 低品質 | 100,000点 | プレビュー用 |

## 🗂️ プロジェクト構造

```
src/
├── index.js              # アプリケーションエントリーポイント
├── App.js                # メインアプリケーションコンポーネント
├── styles.css            # グローバルスタイル
└── components/
    ├── PointCloudViewer.js    # 3D点群表示コンポーネント
    ├── ControlsPanel.js       # 制御パネルコンポーネント
    ├── FileUpload.js          # ファイルアップロードコンポーネント
    └── InfoPanel.js           # 情報表示パネルコンポーネント
```

## 🔧 開発

### 開発環境のセットアップ

```bash
# 依存関係のインストール
npm install

# 開発サーバーの起動（ホットリロード対応）
npm run dev

# 本番ビルド
npm run build
```

### コードの品質

- **ESLint**: コード品質の自動チェック
- **コメント**: 詳細なJSDocコメント
- **型安全性**: PropTypesによる型チェック

## 🌐 ブラウザ対応

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 📝 対応ファイル形式

### LASファイル
- **Point Data Format**: 0, 1, 2, 3, 5, 6, 7, 8, 10
- **色情報**: RGB色情報の正確な読み込み
- **座標系**: 地理座標系と投影座標系の両方に対応

### PLYファイル
- **ASCII形式**: テキスト形式のPLYファイル
- **Binary形式**: バイナリ形式のPLYファイル
- **色情報**: 頂点色情報の読み込み

## ⚠️ 注意事項

- 大容量の点群データを読み込む際は、ブラウザのメモリ使用量にご注意ください
- 品質レベルを下げることで、大規模データでも滑らかに動作します
- 一部の古いブラウザでは正常に動作しない場合があります

## 📄 ライセンス

MIT License

大規模データの表示最適化が完了しました！
実装した最適化機能
✅ 品質レベルシステム
4段階の品質レベル（最高品質〜低品質）
各レベルで異なる点数制限とサンプリング間隔
✅ プログレッシブ読み込み
品質レベルに応じた適応的な点数制限
サンプリング間隔の調整（1点ごと〜10点に1点）
✅ LOD（Level of Detail）システム
最高品質: 100万点（1点ごと）
高品質: 50万点（2点に1点）
中品質: 25万点（4点に1点）
低品質: 10万点（10点に1点）
✅ ユーザーインターフェース
品質レベル調整スライダー
リアルタイム品質表示
使用方法
アプリケーションを起動
大規模データの読み込み
05qf13204d.lasファイルを読み込み
初期は最高品質（100万点）で読み込まれます
品質レベルの調整
コントロールパネルの「品質レベル」スライダーを使用
ブラウザが重い場合は低品質に設定
詳細が必要な場合は最高品質に設定
最適化の効果
メモリ使用量の削減: 品質レベルに応じて最大90%のメモリ削減
レンダリング性能の向上: 点数を制限することでフレームレート向上
ユーザー体験の改善: 滑らかな操作と適応的な品質調整
これで、大規模な点群データでもブラウザが固まることなく、適切な品質で表示できるようになりました。必要に応じて品質レベルを調整して、パフォーマンスと品質のバランスを取ることができます。